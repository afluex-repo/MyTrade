
@{
    ViewBag.Title = "Recharge";
    Layout = "~/Views/Shared/_UserLayout.cshtml";
}
@*<link href="~/MyTradeWebsite/assets/css/style.css" rel="stylesheet" />*@

@*<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>*@

<script src="~/MyTradeWebsite/assets/js/bootstrap.bundle.min.js"></script>
<style>
    #content > .container {
        max-width: 100% !important;
    }

    .tab-content.payment-form {
        background-color: #ecf3f9;
        padding: 20px 20px;
    }

    .contact-form form .form-control, .contact-form form .form-select {
        background-color: #ffffff;
        border: none;
        -webkit-box-shadow: 0px 5px 28.5px 1.5px rgb(149 152 200 / 20%) !important;
        box-shadow: 0px 5px 28.5px 1.5px rgb(149 152 200 / 20%) !important;
        height: 50px;
        font-family: "Raleway", sans-serif;
        font-size: 14.5px;
    }

    .card-billrecharge .nav-tabs .nav-link.active {
        background: #910f10;
        color: #fff;
    }

    .card-billrecharge .nav-tabs .nav-link:hover {
        border: none;
        outline: none;
        background: #fff;
        color: #22396c;
    }

    .card-billrecharge .nav-tabs .nav-link {
        text-align: center;
        background: #22396c;
        color: #fff;
        height: 100%;
        width: 129.6px;
        padding: 15px 10px;
        outline: none;
        border: none;
    }

    .nav-tabs {
        border-bottom: none;
    }

    .tab-content .sub-title {
        display: block;
        margin-bottom: 10px;
        text-transform: capitalize;
        color: #22396c;
        font-size: 16px;
        font-family: "Raleway", sans-serif;
        font-weight: 700;
    }

    .section-title p {
        /* max-width: 500px; */
        margin-left: auto;
        margin-right: auto;
        margin-bottom: 0;
    }

    .section-title .bar {
        height: 5px;
        width: 90px;
        background: #cdf1d8;
        margin: 15px auto 20px;
        position: relative;
        border-radius: 30px;
    }

    a:hover, a:focus {
        color: #f96332;
    }

    .plan {
        color: #e95108;
        outline: none;
        text-align: left;
    }

    .table td, .table th {
        border-top: none;
    }

    ._3H1N {
        background-color: #f8f8f8;
        font-size: 14px;
        overflow-x: scroll;
        display: -ms-flexbox;
        display: flex;
        color: #999;
        overflow: hidden;
        -o-text-overflow: ellipsis;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

        ._3H1N ._3HKw {
            padding: 12px 20px 12px 19px;
            cursor: pointer;
            color: black;
        }

        ._3H1N ._2Xj9 {
            color: #222;
            font-weight: 600;
            border-bottom: 3px solid #00b9f5;
            background: #f3f7f8;
        }

    ._262P {
        display: -ms-flexbox;
        display: flex;
        font-size: 13px;
        color: black;
        border-top: 1px solid #ebebeb;
        border-bottom: 1px solid #ebebeb;
    }

    .zUDk {
        width: 12%;
        padding: 7px 14px;
    }

    ._8nlz {
        height: 210px;
        overflow: scroll;
    }

    ._1aEZ:hover {
        background-color: #f3f7f8;
    }

    ._1aEZ {
        display: -ms-flexbox;
        display: flex;
        padding: 10px 0;
    }

    ._17KN {
        width: 15%;
    }

    ._3WAG {
        width: 37%;
        word-wrap: break-word;
    }

    ._3vjB {
        font-size: 14px;
        padding: 6px 10px;
    }

    .LLvJ {
        color: #00baf2;
        border: 1px solid #00baf2;
    }

    ._11kC {
        border-radius: 6px;
        margin: 0;
        text-align: center;
        font-weight: 600;
    }
</style>
<div class="container">
    <div class="row layout-top-spacing">
        <div class="col-lg-12 col-12 layout-spacing">
            <div class="statbox widget box box-shadow">
                <div class="widget-content widget-content-area">
                    <section class="how-it-works-area ptb-70" id="">
                        <div class="section-title">
                            <h2>Recharge and Bill</h2>
                            <br />
                        </div>
                        <div class="row">
                            <div class="col-lg-12 col-sm-12 col-md-12">
                                <div class="card-billrecharge mb-5">

                                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="home-tab" data-bs-toggle="tab" data-bs-target="#mobile" type="button" role="tab" aria-controls="home" aria-selected="true">Mobile</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#dth" type="button" role="tab" aria-controls="profile" aria-selected="false">DTH</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#data-card" type="button" role="tab" aria-controls="contact" aria-selected="false">Data Card</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#broadband" type="button" role="tab" aria-controls="home" aria-selected="true">Broadband</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#landline" type="button" role="tab" aria-controls="profile" aria-selected="false">Landline</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#cabletv" type="button" role="tab" aria-controls="contact" aria-selected="false">CableTv</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="electricity" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Electricity</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#flight" type="button" role="tab" aria-controls="profile" aria-selected="false">Flight</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#gas" type="button" role="tab" aria-controls="contact" aria-selected="false">Gas</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#water" type="button" role="tab" aria-controls="contact" aria-selected="false">Water</button>
                                        </li>
                                    </ul>

                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12 col-md-12 tab-content payment-form" id="myTabContent">
                                <div class="contact-form tab-pane fade show" id="mobile" role="tabpanel" aria-labelledby="home-tab">
                                    <span class="sub-title">Mobile Recharge or Bill Payment</span>
                                    <form id="contactForm">
                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 d-flex my-3">
                                                <div class="form-check mx-1">
                                                    <input type="radio" class="form-check-input" id="radio1" name="optradio" value="option1" checked>Prepaid
                                                    <label class="form-check-label" for="radio1"></label>
                                                </div>
                                                <div class="form-check mx-1">
                                                    <input type="radio" class="form-check-input" id="radio2" name="optradio" value="option2">Postpaid
                                                    <label class="form-check-label" for="radio2"></label>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12">
                                                <div class="form-group">
                                                    <input type="text" name="MobileNo" id="MobileNo" class="form-control" required data-error="Please enter your mobile number" placeholder="Enter Your Mobile Number">
                                                    <div class="help-block with-errors"></div>
                                                </div>
                                            </div>

                                            <div class="col-lg-12 col-md-12">
                                                <div class="form-group">
                                                    <select class="form-control" id="operator" required>
                                                        <option value="0">-Select Operator-</option>
                                                        @*<option>1 Operator</option>
                                                            <option>2 Operator</option>
                                                            <option>3 Operator</option>
                                                            <option>4 Operator</option>*@
                                                    </select>
                                                    <div class="help-block with-errors"></div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12">
                                                <div class="form-group">
                                                    <select class="form-control" id="circle" required onchange="return GetPlan();">
                                                        <option value="0">-Select Circle-</option>
                                                    </select>
                                                    <div class="help-block with-errors"></div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12">
                                                <div class="form-group">
                                                    <input type="text" name="Amount" id="Amount" class="form-control" required data-error="Please enter amount" placeholder="Enter Amount">
                                                    <div class="help-block with-errors"></div>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12">
                                                <button type="submit" class="btn btn-primary">Continue To Recharge</button>
                                                <div id="msgSubmit" class="h3 text-center hidden"></div>
                                                <div class="clearfix"></div>
                                            </div>
                                        </div>
                                    </form>
                                </div>

                                <div class="tab-pane fade" id="dth" role="tabpanel" aria-labelledby="profile-tab">dth</div>

                                <div class="tab-pane fade" id="data-card" role="tabpanel" aria-labelledby="contact-tab">data card</div>

                                <div class="tab-pane fade" id="broadband" role="tabpanel" aria-labelledby="profile-tab">broadband</div>

                                <div class="tab-pane fade" id="landline" role="tabpanel" aria-labelledby="contact-tab">landline</div>

                                <div class="tab-pane fade" id="cabletv" role="tabpanel" aria-labelledby="profile-tab">cable tv</div>

                                <div class="tab-pane fade" id="electricity" role="tabpanel" aria-labelledby="contact-tab">Electricity</div>

                                <div class="tab-pane fade" id="flight" role="tabpanel" aria-labelledby="profile-tab">flight</div>

                                <div class="tab-pane fade" id="gas" role="tabpanel" aria-labelledby="contact-tab">gas</div>

                                <div class="tab-pane fade" id="water" role="tabpanel" aria-labelledby="contact-tab">Water</div>

                            </div>
                            <div class="col-lg-8 col-sm-12 col-md-12 tab-content payment-form" id="myPlanTab" style="display:none">
                                <div class="">
                                    <div class="_3H1N" id="divplan">
                                    </div>
                                    <div class="">
                                        <div>
                                            <div class="_262P">
                                                <div class="zUDk">Circle</div>
                                                <div class="zUDk">Plan Type</div>
                                                <div class="zUDk">Validity</div>
                                                <div class="zUDk _3WAG">Description</div>
                                                <div class="zUDk _17KN">Price</div>
                                            </div>
                                            <div class="_8nlz" id="plan">

                                            </div><div class="_3yZ3">Disclaimer : <span>While we support most recharges, we request you to verify with your operator once before proceeding.</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/MyTradeWebsite/assets/js/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        GetOperator();
        GetCircle();
    });
    function GetOperator() {
        $.ajax({
            url: '/Recharge/GetOperator',
            Type: "Get",
            DataType: "JSON",
            success: function (data) {
                var obj = JSON.parse(data);
                for (var i = 0; i < obj.response.length; i++) {
                    $("#operator").html(""); // clear before appending new list
                    $("#operator").empty();
                    $("#operator").append(
                          $('<option></option>').val(0).html('Select Operator'));
                    $.each(obj.response, function (index, count) {
                        if (count.service_type == "Prepaid" && count.status == "1") {
                            $("#operator").append(
                             $('<option></option>').val(count.operator_id).html(count.operator_name));
                        }
                    });
                    // APPEND OR INSERT DATA TO SELECT ELEMENT.
                    //$('#Operator').append('<option value="' + obj.response[i].operator_id + '">' + obj.response[i].operator_name + '</option>');
                }
            },
            error: function () {

            }
        });
    }
    function GetCircle() {
        $.ajax({
            url: '/Recharge/GetCircle',
            Type: "Get",
            DataType: "JSON",
            success: function (data) {
                var obj = JSON.parse(data);
                for (var i = 0; i < obj.response.length; i++) {
                    $("#circle").html(""); // clear before appending new list
                    $("#circle").empty();
                    $("#circle").append(
                          $('<option></option>').val(0).html('Select Circle'));
                    $.each(obj.response, function (index, count) {
                        $("#circle").append(
                         $('<option></option>').val(count.circle_code).html(count.circle_name));
                    });
                    // APPEND OR INSERT DATA TO SELECT ELEMENT.
                    //$('#Operator').append('<option value="' + obj.response[i].operator_id + '">' + obj.response[i].operator_name + '</option>');
                }
            },
            error: function () {

            }
        });
    }
    function AutoFillOperator() {
        $.ajax({
            url: '/Recharge/AutoFillOperator',
            data: { MobileNo: $("#MobileNo").val() },
            Type: "Get",
            DataType: "JSON",
            success: function (data) {
                var obj = JSON.parse(data);
                $("#operator option[text=" + obj.details.operator + "]").attr("selected", "selected");
                $("#circle option[text=" + obj.details.Circle + "]").attr("selected", "selected");

            },
            error: function () {

            }
        });
    }
    function GetPlan() {
        debugger;
        $.ajax({
            url: '/Recharge/GetPlan',
            data: { state_code: $("#circle").val(), opid: $("#operator").val() },
            Type: "Get",
            DataType: "JSON",
            success: function (data) {
                debugger;
                var obj = JSON.parse(data);
                var names = Object.getOwnPropertyNames(obj.plans);
                $("#myPlanTab").show();
                $("#divplan").html('');
                for (var i = 0; i < names.length; i++) {
                    debugger;
                    //$("#tblplan").append('<div id="accordion"><div style="border-bottom:1px solid #E1E0D6;text-align:left"><a href="javascript:void(0)" class="plan" aria-expanded="true" onclick="return GetPlanDetails();">' + names[i] + '</a></div><div id="collaps' + names[i] + '" style="display:block"></div></div>');
                    var str = JSON.stringify(names[i]);
                    $("#divplan").append("<div class='_3HKw' onclick='return GetPlanDetails(" + str + ")'>" + names[i] + "</div>");
                }
                for (var i = 0; i < obj.plans.FULLTT.length; i++) {
                    $("#plan").append('<div class="_1aEZ"><div class="zUDk">' + obj.circle + '</div><div class="zUDk">' + obj.plans.FULLTT[i].Type + '</div><div class="zUDk">' + obj.plans.FULLTT[i].validity + '</div><div class="zUDk _3WAG">' + obj.plans.FULLTT[i].desc + '</div><div class="zUDk _17KN"><button class="_11kC  LLvJ _3vjB" onclick="return Setamount(' + obj.plans.FULLTT[i].rs + ')">Rs. ' + obj.plans.FULLTT[i].rs + '</button></div></div>');
                    //$("#tblplan").append('<div class="panel-collapse collapse show" style=""><div class="panel-body"><div class="card" style="width: 100%;"><div class="card-body"><h5 class="card-title"><a class="btn btn-sm btn-primary" onclick="setAmount(' + obj.plans.FULLTT[i].rs + ')"><i class="fa fa-rupee-sign"></i>' + obj.plans.FULLTT[i].rs + '</a></h5><p class="card-text">' + obj.plans.FULLTT[i].desc + '</p><h6 class="card-subtitle mb-2 text-muted">Validity ' + obj.plans.FULLTT[i].validity + '</h6></div></div></div></div></div>')
                }
            },
            error: function () {

            }
        });
    }
    function GetPlanDetails(str) {
        debugger;
        $.ajax({
            url: '/Recharge/GetPlan',
            data: { state_code: $("#circle").val(), opid: $("#operator").val() },
            Type: "Get",
            DataType: "JSON",
            success: function (data) {
                debugger;
                var obj = JSON.parse(data);
                if (str == "FULLTT") {
                    $("#plan").html('');
                    for (var i = 0; i < obj.plans.FULLTT.length; i++) {
                        $("#plan").append('<div class="_1aEZ"><div class="zUDk">' + obj.circle + '</div><div class="zUDk">' + obj.plans.FULLTT[i].Type + '</div><div class="zUDk">' + obj.plans.FULLTT[i].validity + '</div><div class="zUDk _3WAG">' + obj.plans.FULLTT[i].desc + '</div><div class="zUDk _17KN"><button class="_11kC  LLvJ _3vjB">Rs. ' + obj.plans.FULLTT[i].rs + '</button></div></div>');
                    }
                }
                if (str == "TOPUP") {
                    $("#plan").html('');
                    for (var i = 0; i < obj.plans.TOPUP.length; i++) {
                        $("#plan").append('<div class="_1aEZ"><div class="zUDk">' + obj.circle + '</div><div class="zUDk">' + obj.plans.TOPUP[i].Type + '</div><div class="zUDk">' + obj.plans.TOPUP[i].validity + '</div><div class="zUDk _3WAG">' + obj.plans.TOPUP[i].desc + '</div><div class="zUDk _17KN"><button class="_11kC  LLvJ _3vjB">Rs. ' + obj.plans.TOPUP[i].rs + '</button></div></div>');
                    }
                }
                if (str == "DATA") {
                    $("#plan").html('');
                    for (var i = 0; i < obj.plans.DATA.length; i++) {
                        $("#plan").append('<div class="_1aEZ"><div class="zUDk">' + obj.circle + '</div><div class="zUDk">' + obj.plans.DATA[i].Type + '</div><div class="zUDk">' + obj.plans.DATA[i].validity + '</div><div class="zUDk _3WAG">' + obj.plans.DATA[i].desc + '</div><div class="zUDk _17KN"><button class="_11kC  LLvJ _3vjB">Rs. ' + obj.plans.DATA[i].rs + '</button></div></div>');
                    }
                }
                if (str == "SMS") {
                    $("#plan").html('');
                    for (var i = 0; i < obj.plans.SMS.length; i++) {
                        $("#plan").append('<div class="_1aEZ"><div class="zUDk">' + obj.circle + '</div><div class="zUDk">' + obj.plans.SMS[i].Type + '</div><div class="zUDk">' + obj.plans.SMS[i].validity + '</div><div class="zUDk _3WAG">' + obj.plans.SMS[i].desc + '</div><div class="zUDk _17KN"><button class="_11kC  LLvJ _3vjB">Rs. ' + obj.plans.SMS[i].rs + '</button></div></div>');
                    }
                }
                if (str == "Romaing") {
                    $("#plan").html('');
                    for (var i = 0; i < obj.plans.Romaing.length; i++) {
                        $("#plan").append('<div class="_1aEZ"><div class="zUDk">' + obj.circle + '</div><div class="zUDk">' + obj.plans.Romaing[i].Type + '</div><div class="zUDk">' + obj.plans.Romaing[i].validity + '</div><div class="zUDk _3WAG">' + obj.plans.Romaing[i].desc + '</div><div class="zUDk _17KN"><button class="_11kC  LLvJ _3vjB">Rs. ' + obj.plans.Romaing[i].rs + '</button></div></div>');
                    }
                }
                if (str == "FRC") {
                    $("#plan").html('');
                    for (var i = 0; i < obj.plans.FRC.length; i++) {
                        $("#plan").append('<div class="_1aEZ"><div class="zUDk">' + obj.circle + '</div><div class="zUDk">' + obj.plans.FRC[i].Type + '</div><div class="zUDk">' + obj.plans.FRC[i].validity + '</div><div class="zUDk _3WAG">' + obj.plans.FRC[i].desc + '</div><div class="zUDk _17KN"><button class="_11kC  LLvJ _3vjB" onclick="return Setamount(' + obj.plans.FRC[i].rs + ')">Rs. ' + obj.plans.FRC[i].rs + '</button></div></div>');
                    }
                }
                if (str == "STV") {
                    $("#plan").html('');
                    for (var i = 0; i < obj.plans.FRC.length; i++) {
                        $("#plan").append('<div class="_1aEZ"><div class="zUDk">' + obj.circle + '</div><div class="zUDk">' + obj.plans.STV[i].Type + '</div><div class="zUDk">' + obj.plans.STV[i].validity + '</div><div class="zUDk _3WAG">' + obj.plans.STV[i].desc + '</div><div class="zUDk _17KN"><button class="_11kC  LLvJ _3vjB">Rs. ' + obj.plans.STV[i].rs + '</button></div></div>');
                    }
                }
            },
            error: function () {

            }
        });
    }
    function SetAmount(price) {
        $("#Amount")
    }
</script>
